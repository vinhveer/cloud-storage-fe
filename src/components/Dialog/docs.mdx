import React from 'react'
import Dialog from '@/components/Dialog/Dialog'

# Dialog

Hộp thoại xác nhận đơn giản, hỗ trợ controlled/uncontrolled, backdrop/Escape và a11y.

## Mục đích & trường hợp xử lý

- Xác nhận hành động quan trọng (xóa, rời trang, v.v.).
- Hỗ trợ chế độ controlled (`open`, `onOpenChange`) và uncontrolled (`defaultOpen`).
- Đóng bằng phím `Escape` và click backdrop (có thể tắt từng cái).
- Nút Confirm có 3 kiểu: `danger | primary | neutral`.

## Props

| Tên | Kiểu | Mặc định | Mô tả |
| --- | --- | --- | --- |
| id | `string` | sinh tự động | Id gốc của modal (phục vụ aria-*) |
| title | `string` | - | Tiêu đề hộp thoại |
| confirmText | `string` | `'Are you sure?'` | Nội dung xác nhận |
| confirmButtonText | `string` | `'Confirm'` | Nhãn nút xác nhận |
| cancelButtonText | `string` | `'Cancel'` | Nhãn nút hủy |
| confirmHref | `string` | `'#'` | Liên kết mặc định khi không có `onConfirm` |
| confirmType | `'danger' \| 'primary' \| 'neutral'` | `'danger'` | Kiểu nút xác nhận |
| open | `boolean` | - | Trạng thái controlled |
| defaultOpen | `boolean` | `false` | Trạng thái ban đầu ở uncontrolled |
| onOpenChange | `(open: boolean) => void` | - | Callback khi đổi trạng thái |
| onConfirm | `() => void \| Promise<void>` | - | Xử lý khi nhấn Confirm (prevent default, auto đóng sau khi xong) |
| onCancel | `() => void` | - | Xử lý khi nhấn Cancel/đóng |
| closeOnEsc | `boolean` | `true` | Cho phép đóng bằng phím Escape |
| closeOnBackdrop | `boolean` | `true` | Cho phép đóng khi click nền |
| className | `string` | - | Bổ sung class Tailwind |

## Cách dùng
```tsx
function Example() {
  const [open, setOpen] = React.useState(false)
  return (
    <>
      <button className="btn btn-primary btn-md" onClick={() => setOpen(true)}>Open</button>
      <Dialog title="Confirm" confirmText="Are you sure?" open={open} onOpenChange={setOpen} />
    </>
  )
}
```

### Demos

```tsx
import Dialog from '@/components/Dialog/Dialog'
```

#### Cơ bản (mở/đóng thủ công)

- Mô tả: Nút mở modal, quản lý bằng state nội bộ.

```tsx
function Example() {
  const [open, setOpen] = React.useState(false)
  return (
    <>
      <button className="btn btn-primary btn-md" onClick={() => setOpen(true)}>Open Dialog</button>
      <Dialog title="Confirm Action" confirmText="Are you sure?" confirmButtonText="Confirm" cancelButtonText="Cancel" confirmType="danger" open={open} onOpenChange={setOpen} />
    </>
  )
}
```

{(() => {
  const [open, setOpen] = React.useState(false)
  return (
    <div className="space-y-2">
      <button className="btn btn-primary btn-md" onClick={() => setOpen(true)}>Open Dialog</button>
      <Dialog title="Confirm Action" confirmText="Are you sure?" confirmButtonText="Confirm" cancelButtonText="Cancel" confirmType="danger" open={open} onOpenChange={setOpen} />
    </div>
  )
})()}

#### Controlled với onConfirm async

- Mô tả: Thực thi logic async trước khi đóng.

```tsx
function Example() {
  const [open, setOpen] = React.useState(false)
  return (
    <>
      <button className="btn btn-secondary btn-md" onClick={() => setOpen(true)}>Open</button>
      <Dialog title="Update Settings" confirmText="Apply changes?" confirmButtonText="Apply" cancelButtonText="Cancel" confirmType="primary" open={open} onOpenChange={setOpen} onConfirm={async () => { await new Promise(r => setTimeout(r, 300)); }} />
    </>
  )
}
```

{(() => {
  const [open, setOpen] = React.useState(false)
  return (
    <div className="space-y-2">
      <button className="btn btn-secondary btn-md" onClick={() => setOpen(true)}>Open</button>
      <Dialog title="Update Settings" confirmText="Apply changes?" confirmButtonText="Apply" cancelButtonText="Cancel" confirmType="primary" open={open} onOpenChange={setOpen} onConfirm={() => { setTimeout(() => setOpen(false), 300) }} />
    </div>
  )
})()}

#### Variants (danger/primary/neutral)

- Mô tả: Các kiểu nút Confirm thể hiện mức độ rủi ro.

```tsx
function Example() {
  const [dangerOpen, setDangerOpen] = React.useState(false)
  const [primaryOpen, setPrimaryOpen] = React.useState(false)
  const [neutralOpen, setNeutralOpen] = React.useState(false)
  return (
    <>
      <div className="flex gap-2">
        <button className="btn btn-danger btn-md" onClick={() => setDangerOpen(true)}>Danger</button>
        <button className="btn btn-primary btn-md" onClick={() => setPrimaryOpen(true)}>Primary</button>
        <button className="btn btn-secondary btn-md" onClick={() => setNeutralOpen(true)}>Neutral</button>
      </div>
      <Dialog title="Delete Item" confirmText="This action cannot be undone." confirmButtonText="Delete" cancelButtonText="Cancel" confirmType="danger" open={dangerOpen} onOpenChange={setDangerOpen} />
      <Dialog title="Publish" confirmText="Publish this document?" confirmButtonText="Publish" cancelButtonText="Cancel" confirmType="primary" open={primaryOpen} onOpenChange={setPrimaryOpen} />
      <Dialog title="Proceed" confirmText="Continue to the next step?" confirmButtonText="Continue" cancelButtonText="Cancel" confirmType="neutral" open={neutralOpen} onOpenChange={setNeutralOpen} />
    </>
  )
}
```

{(() => {
  const [dangerOpen, setDangerOpen] = React.useState(false)
  const [primaryOpen, setPrimaryOpen] = React.useState(false)
  const [neutralOpen, setNeutralOpen] = React.useState(false)
  return (
    <div className="space-y-2">
      <div className="flex gap-2">
        <button className="btn btn-danger btn-md" onClick={() => setDangerOpen(true)}>Danger</button>
        <button className="btn btn-primary btn-md" onClick={() => setPrimaryOpen(true)}>Primary</button>
        <button className="btn btn-secondary btn-md" onClick={() => setNeutralOpen(true)}>Neutral</button>
      </div>
      <Dialog title="Delete Item" confirmText="This action cannot be undone." confirmButtonText="Delete" cancelButtonText="Cancel" confirmType="danger" open={dangerOpen} onOpenChange={setDangerOpen} />
      <Dialog title="Publish" confirmText="Publish this document?" confirmButtonText="Publish" cancelButtonText="Cancel" confirmType="primary" open={primaryOpen} onOpenChange={setPrimaryOpen} />
      <Dialog title="Proceed" confirmText="Continue to the next step?" confirmButtonText="Continue" cancelButtonText="Cancel" confirmType="neutral" open={neutralOpen} onOpenChange={setNeutralOpen} />
    </div>
  )
})()}

## Lưu ý

- Controlled: truyền `open` và `onOpenChange`. Uncontrolled: dùng `defaultOpen`.
- `onConfirm` nếu có sẽ `preventDefault()`, chạy async và tự đóng sau khi hoàn tất.
- Nếu không có `onConfirm`, nút Confirm là link điều hướng theo `confirmHref`.
- `closeOnEsc`/`closeOnBackdrop` điều khiển hành vi đóng; tắt nếu cần bắt buộc thao tác.
- Modal đã có `role="dialog"`, `aria-modal`, `aria-labelledby`, `aria-describedby`.


